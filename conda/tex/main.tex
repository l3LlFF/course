\documentclass[12pt, a4paper]{article}

% Поля страницы
\usepackage{geometry}
\geometry{left=2cm}
\geometry{right=1cm}
\geometry{top=2cm}
\geometry{bottom=2cm}

%Package mandatory for each paper\
\usepackage{indentfirst}
\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{amsbsy}
\usepackage{comment}
\usepackage[pdftex]{graphicx}
\usepackage{epstopdf}
\usepackage{scalefnt}
\usepackage{multirow}
\usepackage{float}
\floatstyle{plaintop}
\restylefloat{table}
\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}
\newcommand{\thb}{{\boldsymbol \theta}}
\newcommand{\eb}{{\bf e}}
\newcommand{\nut}{\nu_t, \: t \geq 0}
\newcommand{\pib}{{\boldsymbol \pi}}
\newcommand{\pb}{{\bf p}}
\def\bs{\boldsymbol}
%Packages required by this paper
\usepackage{rotating, longtable, hhline}
\usepackage{amsmath, amsfonts, amssymb, amsthm}

\usepackage{float}
\restylefloat{table}
\begin{document}



\begin{titlepage}
\begin{center}
  \textbf{\uppercase{Министерство Образования Республики Беларусь}}
\end{center}
\begin{center}
  \textbf{\uppercase{Белорусский Государственный Университет}}
\end{center}
\begin{center}
  \textbf{Факультет прикладной математики и информатики}
\end{center}
\begin{center}
  Кафедра теории вероятностей и математической статистики
\end{center}
\vfill

\begin{center}
  \uppercase{\large{\bf{Система массового обслуживани $M/G/1$ с запасами как модель узла беспроводной сенсорной сети со сбором энергии}}}
\end{center}

\vfill

\begin{tabular}{p{90mm}p{90mm}}

&
Бокши Виктора Александровича \newline
 \newline
студента 4 курса, \newline
специальность \newline
"Прикладная математика" \newline
 \newline
Научный руководитель: \newline
 \newline
  доктор физико-математических наук, \newline 
   \newline
  профессор В.И. Клименок\newline

  \vskip 1em
\end{tabular}
\vfill
\vfill
\begin{center}Минск, 2021\end{center}
\end{titlepage}
\setcounter{page}{2}



\tableofcontents
\newpage



%-------------------------------------- ВВЕДЕНИЕ ----------------------------------------

\begin{center} {\bf {ВВЕДЕНИЕ}} \end{center}

Беспроводные сенсорные узлы (WSN) в последние годы привлекают все больше внимания. Одним из главных преимуществ сенсорных узлов является их способность постоянно отслеживать данные различных параметров. Эти датчики используются, например, в системах водоснабжения для контроля параметров жидкости и потока. Одной из проблем сенсорных узлов является их электроснабжение. Узлы WSN обычно питаются от аккумуляторов и как только срок службы батарей истечет, их необходимо заменить или подзарядить. Поскольку сенсорный узел может быть размещен в удаленном месте, замена батарей не всегда практична. 

Поэтому были предложены различные методы для замедления истощения энергии батареи, которые включают регулирование мощности и использование режима работы на основе рабочего цикла. Последний метод использует режимы низкой мощности беспроводных приемопередатчиков, компоненты которых могут быть отключены для экономии энергии. Когда узел находится в режиме низкого энергопотребления, его потребление значительно ниже, чем при включенном приемопередатчике. Однако в спящем режиме узел не может передавать или принимать пакеты. Рабочий цикл выражает соотношение между временем, когда узел включен, и суммой времени, когда узел включен и спит. Внедрение прототипов, работающих с очень низкими рабочими циклами, является ведущим типом решения для обеспечения длительных WSN. Однако этот подход страдает двумя основными недостатками. 
\begin{itemize}
\item[$\bullet$] Существует неизбежный компромисс между энергоэффективностью и задержкой передачи данных
\item[$\bullet$] WSN с батарейным питанием не обеспечивают необходимого ответа на требования многих новых приложений, для которых требуется срок службы сети в течение десятилетий или более. 
\end{itemize}

Существующий подход к решению этой проблемы заключается в добавлении системы аккумулирования энергии из окружающей среды (солнечная, ветровая, звуковая, вибрационная, тепловая и электромагнитная энергия). Непрерывно обеспечивая энергию и сохраняя ее для будущего использования, подсистемы сбора энергии позволяют узлам WSN работать потенциально вечно.

В данной работе исследуются стационарные характеристики системы массового обслуживания с запасами как модель узла WSN со сбором энергии.. Система состоит из прибора, моделирующего работу узла WSN и конечного буфера размера $K$, в который поступают единицы энергии в стационарном пуассоновском потоке. В качестве входящего потока рассматривается $MAP$-поток. В работе функционирование системы описывается многомерной цепью Маркова, вычисляется ее стационарное распределение, выводятся и исследуются численно характеристики производительности системы.

\newpage

\section{Математическая модель}

%-------------------------------------- Описание системы ----------------------------------------

\subsection{Описание системы}

Рассматривается однолинейная система массового обслуживания $MAP/G/1$. Поступление запросов происходит в марковском входном потоке ($MAP$), более подробное описание в \cite{bi:1}. Предполагается, что запросы могут поступать в моменты переходов неприводимой ЦМ $\nu_t, \,  t\geq1$, с инфинитезимальным генератором $D(1)=D_0+D_1$ и конечным пространством состояний $\{0, 1, ..., W\}$. Элементы квадратной матрицы $D_1$ порядка $\bar{W}=W+1$ определяют мгновенные интенсивности переходов цепи $\nu_t$, сопровождающиеся генерацией одной заявки. Недиагональные элементы матрицы $D_0$ определяют мгновенные интенсивности переходов цепи $\nu_t$, не сопровождающиеся генерацией заявок.

Вектор-строка ${\boldsymbol \theta}$ стационарного распределения цепи $\nu_t$ 
есть единственное решение СЛАУ ${\boldsymbol \theta} D(1)={\bf 0}, \, {\boldsymbol \theta}{\bf e}=1$. Здесь и в далее предполагается, что  ${\bf e}$ -- единичный вектор-столбец соответствующего размера, а ${\bf 0}$ -- вектор-строка, соответствующего размера и состоящая из нулей. Средняя интенсивность поступления запросов $\lambda$ определяется формулой $\lambda={\boldsymbol \theta}D_1{\bf e}$.

Обслуживание поступающего запроса возможно только при наличии единицы энергии в конечном буфере, в котором помещается $K$ таких единиц. Если запрос прибывает на обслуживание, когда прибор занят или в буфере нет энергии, то он становится в конец очереди бесконечного размера. Запросы выбираются из очереди на обслуживание в соответствии с дисциплиной FIFO («первым пришел - первым ушел»). Время обслуживания запроса  имеет произвольную функцию  распределения $B (t)$ с преобразованием Лапласа-Стилтьеса  $\beta(s)=\int\limits_0^ \infty e^{-st}d B(t)$ и средним $b_1<\infty$.

Единицы  энергии поступают в буфер для энергии в  стационарном пуассоновском потоке  с интенсивностью $\gamma.$ Если в момент поступления единицы энергии буфер полностью заполнен, то поступающая единица энергии теряется (возможно, перенаправляется на другой объект). В то же время единица энергии забирается из буфера в момент начала обслуживания запроса на приборе, так как для обслуживания одного запроса требуется одна единица энергии.

Нашей целью является анализ стационарного поведения двумерного стохастического процесса $\tilde  \zeta_t=\{i_{t}, k_{t}\},\; t \ge 0,$ где $i_t$ -- число запросов, и $k_t$  -- число единиц энергии в системе в момент $t,\; i_t \ge 0,\; k_t=\overline{0,K}$. Стохастический процесс $\tilde  \zeta_t$ не является марковским, потому для его исследования будем применять метод вложенных цепей Маркова.

\newpage

%--------------------------------- Цепь Маркова, описывающая поведение системы ---------------------------------

\section{Стационарное распределение вероятностей вложенной ЦМ}

\subsection{Вложенная цепь Маркова. Переходные вероятности}
Пусть $t_n$ -- момент окончания обслуживания запросов, $n\geq1$, $i_n$ -- число запросов в системе в момент $t_n+0, \, i_n\geq0$, и $k_n$ -- число единиц энергии в системе в момент $t_n-0, \,k_n=\overline{0, K}$. Рассмотрим трехмерный стохастический процесс
$$
\xi_n=\{i_n,k_n,\nu_n\},\; n \ge1,
$$
где $\nu_n$ -- состояние управляющего процесса $MAP$-потока в момент $t_n, \,\nu_n=\overline{0,W}$.

Несложно видеть, что этот процесс является цепью Маркова с дискретным временем. Для доказательства данного утверждения необходимо ввести выражения для вероятностей одношагового перехода данной цепи. Будем называть уровнем $(i,k)$ множество состояний процесса $\xi_k$, у которых значение первых двух комнонент равно $(i,k)$. Каждый уровень состоит из $W+1$ состояния $(i,k,\nu), \nu=\overline{0,W}$.

Пусть $P\{(i,k)->(j,k')\}$ -- матрица переходных вероятностей с уровня $(i,k)$ на уровень $(j,k')$, или матрица $(\nu, \nu')$ элемент которой есть вероятность одношагового перехода
 $$P\{ (i ,k, \nu) \to (j, k', \nu')\} =P\left\{i_{n+1} = j, k_{n+1} = k', \nu_{n+1} = \nu' |i_{n} = i, k_{n} = k, \nu_{n} = \nu \right\}.$$

Чтобы представить выражения для вероятностей $P\{(i,k)->(j,k')\}$, необходимо ввести следующие обозначения:

\begin{itemize}
\item[$\bullet$]

Вероятность поступления $k$ единиц энергии за время $t$

$$\varphi_{k}(t) = \frac{(\gamma t)^{k} }{k!} e^{-\gamma t},\; k \geq 0$$.

\item[$\bullet$]
Вероятность поступления не менее $k$ единиц энергии за время $t$

$$ \hat\varphi_{k}(t) = \sum\limits_{i=k}^{\infty} \varphi_{i}(t),\; k \geq 0$$.

\item[$\bullet$]
Вероятность поступления $k$ единиц энергии за время обслуживания одного запроса
$$ \varphi_{k} =   \int\limits_{0}^{\infty}\varphi_{k}(t)dB(t),\; k \geq 0.$$

\item[$\bullet$]
Вероятность поступления не менее $k$ единиц энергии за время обслуживания одного запроса

$$ \hat\varphi_{k} = \sum\limits_{i=k}^{\infty} \varphi_{i},\; k \geq 0$$.

\item[$\bullet$]
Матрица $P(i,t)$, элементы которой задают вероятность поступления $i$ запросов  за время $t$ при соответствующих переходах управляющего процесса $MAP$-потока. Матричная производящая функция имеет следующий вид

$$
\sum\limits_{i=0}^{\infty} P(i,t) z^i = e^{(D_0+D_1z)t},\;|z|<1.$$

\item[$\bullet$]
Матрица, элементы которой задают вероятности поступления $i$ запросов и $k$ единиц энергии за время обслуживания одного запроса при соответствующих переходах управляющего процесса $\nu_t$ $MAP$-потока

$$ \Phi(i,k) =  \int\limits_{0}^{\infty} P(i,t)\varphi_{k}(t)dB(t),\; i \geq 0,\; k \geq 0$$.

\item[$\bullet$] Матрица, элементы которой задают вероятности поступления $i$ запросов и не менее $k$ единиц энергии за время обслуживания одного запроса при соответствующих переходах управляющего процесса $\nu_t$ $MAP$-потока

$$ \hat\Phi(i, k) = \int\limits_{0}^{\infty}  P(i, t) \hat\varphi_{k}(t)dB(t),\; i \geq 0,\; k \geq 0$$.

\item[$\bullet$]
Матрица, элементы которой задают вероятности поступления $m$ запросов за время отсутствия единиц энергии при соответствующих переходах управляющего процесса $\nu_t$ $MAP$-потока

$$ N(m) = \int\limits_{0}^{\infty} P(m, t)\gamma e^{-\gamma t}dt,\; m \ge 0$$.

\item[$\bullet$]
Матрица, элементы которой задают вероятности поступления $r$ единиц энергии за время отсутствия запросов при соответствующих переходах управляющего процесса $\nu_t$ $MAP$-потока

$$ M(r) = \int\limits_{0}^{\infty} e^{D_{0}t}\varphi_{r}(t)D_{1}dt =
	\int\limits_{0}^{\infty} e^{D_{0}t}\frac{(\gamma t)^{r} }{r!} e^{-\gamma I t}D_{1}dt = \gamma^{r}(-D_{0} +  \gamma I)^{-(r+1)}D_{1}
$$.

\item[$\bullet$]
Матрица, элементы которой задают вероятности поступления не менее $r$ единиц энергии за время отсутствия запросов при соответствующих переходах управляющего процесса $\nu_t$ $MAP$-потока


$$ \hat M(r) = \sum\limits_{l=r}^{\infty} M(l)=\gamma^{r}(-D_{0} +  \gamma I)^{-r}(-D_0)^{-1}D_{1},\; r \ge 0.$$

\end{itemize}

Для подсчета $P(n,t)$ будем использовать процедуру униформизации.

Обозначим  $h=\max\limits_{i=\overline{0,W}}(-D_0)_{ii}$.

Тогда матрица  $P(n,t),\; n\ge 1,$ может быть представлена в следующем виде:
$$
P(n,t)=\sum_{j=0}^{\infty}e^{-h t}{(h
t)^j\over j!}K_n^{(j)},\; n\ge 0, 
$$

где матрицы $K_n^{(j)},\; n\ge 1, j\ge 0,$ вычисляются из рекурсии

$$
K_0^{(0)}=I,\ K_n^{(0)}=O,\ n\ge 1,
$$ $$
K_0^{(j+1)}=K_0^{(j)}(I+h^{-1}D_0),
$$ $$
K_n^{(j+1)}=h^{-1}K_{n-1}^{(j)}D_1+K_n^{(j)}(I+h^{-1}D_0),\; n\ge 1,\; j\ge 0.
$$

В данной работе мы будем считать, что время обслуживания имеет детерминированное распределение. То есть $B(t)$ имеет вид

$$
B(t)=\left\{
\begin{array}{cc}
0, & \;t\leq b_1,\\
1, & \;t>b_1.
\end{array}
\right.
$$

Тогда введенные выше обозначения примут вид

\begin{itemize}
\item[$\bullet$]

$ \Phi(i,k) =  P(i,b_1)\varphi_{k}(b_1)=e^{-(h+\gamma)b_1}\frac{(\gamma b_1)^k}{k!}\sum\limits_{j=0}^{\infty}\frac{(hb_1)^j}{j!}K_i^{(j)},\;$ $ i \geq 0,\; k \geq 0$.

\item[$\bullet$] 

$\hat \Phi(i,k) =  P(i,b_1)\hat \varphi_{k}(b_1)=e^{-(h+\gamma)b_1}\sum\limits_{j=0}^{\infty}\frac{(hb_1)^j}{j!}K_i^{(j)}\sum\limits_{l=k}^{\infty}\frac{(\gamma b_1)^l}{l!},\;$ $ i \geq 0,\; k \geq 0$.

\item[$\bullet$]

$ N(m) = \gamma\sum\limits_{j=0}^{\infty}\frac{h^j}{j!}K_m^{(j)} \int\limits_{0}^{\infty}e^{-(h+\gamma) t}t^jdt=\frac{\gamma}{h+\gamma} \sum\limits_{j=0}^{\infty}(\frac{h}{h+\gamma})^jK_m^{(j)},\;$ $m \ge 0$.

\end{itemize}

{\bf Лемма}
Матрицы вероятностей перехода $P\left\{(i,k) \to (j, k')\right\}, j\geq \max\{0, i-1\},$ определяются следующим образом:

$$P\left\{(0, 0) \to (j, k' ) \right\}=M(0)\sum\limits_{n = 0}^{j}N(n)\Phi(j-n, k') + N(0)\sum\limits_{m = 0}^{k'}M(m)\Phi(j, k' - m),$$
$$\; k'= {\overline{0,K-2}};$$


$$P\left\{(0, 0) \to (j,K-1 ) \right\}= N(0)\biggl[\sum\limits_{m = 0}^{K-1}M(m)\Phi(j, K-1 - m)
+\hat {M}(K) \Phi(j, 0)\biggr] $$$$+M(0)\sum\limits_{n = 0}^{j}N(n)\Phi(j-n, K-1);$$


$$P\left\{(0, 0) \to (j, K) \right\}= N(0)\biggl[\sum\limits_{m = 0}^{K-1}M(m)\hat\Phi(j, K - m) + \hat M(K)\hat \Phi(j, 1)\biggr]
$$$$+M(0)\sum\limits_{n = 0}^{j}N(n)\hat\Phi(j-n, K);$$

$$P\left\{(0, k) \to (j, k') \right\}=\sum\limits_{m = 0}^{k'-k+1}M(m)\Phi(j,k' - k + 1 - m),\;  k=\overline{1,K}, k' =\overline{k-1, {K-2}};$$

{$$P\left\{(0, k) \to (j, K-1) \right\}=\sum\limits_{m = 0}^{K-k}M(m)\Phi(j,K-k - m)+
\hat{M}(K-k+1)\Phi(j,0),\; k=\overline{1,K};
$$
 }

$$P\left\{(0, k) \to (j, K)\right\}=\sum\limits_{m = 0}^{K-k}M(m) \hat \Phi(j, K - k + 1 - m) + \hat M(K - k + 1)\hat \Phi(j, 1),\;  k =\overline{1,K};$$

$$P\left\{(i, 0) \to (j, k')  \right\}= \sum\limits_{m = 0}^{j - i + 1}N(m)\Phi(j - i + 1 - m, k'),\; i\geq 1,\;  k' =\overline{0, K-1}; $$

$$P\left\{(i, 0) \to (j, K) \right\}=\sum\limits_{m = 0}^{j - i + 1}N(m)\hat \Phi(j - i + 1 - m, K),\; i \geq 1; $$

$$P\left\{(i, k) \to (j, k') \right\} =\Phi(j - i + 1, k' - k+1),\; i \geq 1,\;  k' =\overline{k-1, K-1},\; k=\overline{1,K};$$

$$P\left\{(i, k) \to (j, K)\right\}= \hat \Phi(j - i + 1, K - k+1),\; i \geq 1,\;  k=\overline{1,K}.$$

Доказательство проводится путем анализа вероятностных переходов компонент ЦМ $\xi_t$ между двумя успешными моментами окончания обслуживания, учитывая вероятностный смысл обозначений, приведенных выше.



{\bf Следствие}
Пусть

 $$
     \Psi_1(t) =\left(\begin{array}{ccccc}
     O& O    &   \ldots &   O        &      O   \\
       \varphi_0(t)     & \varphi_1(t)    & \ldots  & \varphi_{K-1}(t)  & \hat \varphi_K(t)  \\
     O &  \varphi_0(t)     &  \ldots  & \varphi_{K-2}(t)  & \hat \varphi_{K-1}(t)  \\
                  \vdots & \vdots &\ddots& \vdots& \vdots       \\
              O& O    &        \ldots  &      \varphi_0(t)     &   \hat \varphi_1(t)        \\
      \end{array} \right),
  $$
   $$
     \Psi_0(t) =\left(\begin{array}{ccccc}
       \varphi_0(t)     & \varphi_1(t)    & \ldots  & \varphi_{K-1}(t)  & \hat \varphi_K(t)  \\
     O& O    &   \ldots &   O        &      O   \\
                         \vdots & \vdots &\ddots& \vdots& \vdots       \\
             O& O    &   \ldots &   O        &      O   \\
      \end{array} \right).
  $$
Тогда блочные матрицы $P_{i,j}$, составленные из блоков $P\left\{(i, k) \to (j, k') \right\},\;k' =\overline{\max\{0,k-1\}, K},\; k=\overline{0,K},$
для $ i \ge 1$
определяются следующим образом
  $$
  P_{i,j}=Y_{j-i+1},\; j\ge i-1,
  $$
где матрицы $Y_l$ заданы формулой
  $$
  Y_l=\int\limits_{0}^{\infty} \Psi_1(t) \otimes P(l, t) d B(t)+\sum\limits_{m=0}^{l} \int\limits_{0}^{\infty}\Psi_0(t) \otimes N(m) P(l-m, t) d B(t), \; l \ge 0.
  $$
  
Матричная производящая функция $Y(z)=\sum\limits_{l=0}^{\infty} Y_l z^l,\;|z|<1,$ для матриц $Y_l, \; l \ge 0,$
имеет следующий вид:
    $$
  Y(z)=\int\limits_{0}^{\infty} \Psi_1(t) \otimes e^{D(z)t} d B(t)+ \gamma \int\limits_{0}^{\infty}\Psi_0(t) \otimes (\gamma I -D(z))^{-1} e^{D(z)t} d B(t). \eqno(1) $$

    Здесь $\otimes$ символ кронекерова произведения матриц.

В свою очередь, блочные матрицы $P_{0,j}$, состоящие из блоков  $P\left\{(0, k) \to (j, k') \right\},\;$ $k=\overline{0,K},$ $k' =\overline{\max\{0,k-1\}, K},\;$обозначим как
  $P_{0,j}=V_j,\;j \ge0.$ Также определим матричную ПФ $V(z)=\sum\limits_{l=0}^{\infty} V_l z^l,\;|z|<1.$


%--------------------------------- Условие эргодичности ----------------------------------


\section{Условие эргодичности}

Из Следствия 1 вытекает, что ЦМ $\xi_n$ принадлежит к классу ЦМ типа $M/G/1$, или многомерной квазитеплицевой цепи Маркова (КТЦМ).
Из \cite{neuts1989} следует , что условие эргодичности для ЦМ $\xi_n$ есть выполнение неравенства
$$
{\bf y}\sum\limits_{k = 1}^{\infty}kY_{k}{\bf e}= {\bf y}Y'(1){\bf e}< 1\; \eqno(2)
$$
где вектор ${\bf y}$  -- единственное решение СЛАУ
$$
{\bf y}\sum\limits_{k = 0}^{\infty}Y_{k} = {\bf y}Y(1) =  {\bf y},\;\;
{\bf y}{\bf  e} = 1. \eqno(3)
$$
Путем прямой подстановки в (3), где матрица $Y(1)$ получена из (1), можно показать, что (3) имеет форму

$${\bf y} = {\bf u}  \otimes {\boldsymbol \theta} \eqno(4)$$
где ${\boldsymbol \theta}$ -- вектор стационарного распределения управляющего процесса $\nu_t$ $MAP$-потока и ${\bf u}= (u_{0},u_{1}, \dots, u_{K})$ -- единственное решение СЛАУ
\if 0
$$
{\bf u}\int\limits_0^{\infty} \left(\begin{array}{ccccc}
     \varphi_0(t)     & \varphi_1(t)    & \ldots  & \varphi_{K-1}(t)  & \hat \varphi_K(t)   \\
       \varphi_0(t)     & \varphi_1(t)    & \ldots  & \varphi_{K-1}(t)  & \hat \varphi_K(t)  \\
     O &  \varphi_0(t)     &  \ldots  & \varphi_{K-2}(t)  & \hat \varphi_{K-1}(t)  \\
                  \vdots & \vdots &\ddots& \vdots& \vdots       \\
              O& O    &        \ldots  &      \varphi_0(t)     &   \hat \varphi_1(t)        \\
      \end{array} \right)d B(t)= {\bf u},\; {\bf u}{\bf e} =1.\eqno(5)
      $$
      \fi

      $$
{\bf u}\int\limits_0^{\infty}(\Psi_0(t)+\Psi_1(t))d B(t)= {\bf u},\; {\bf u}{\bf e} =1.\eqno(5)
$$

Систему (5) можно переписать в следующей форме
$$
u_{k} = u_{0}\varphi_{k} + \sum\limits_{l=1}^{k+1}u_{l}\varphi_{k + 1 - l}, k = \overline{0, K-1},\\
u_{K} = u_{0}\hat\varphi_{K} + \sum\limits_{l=1}^{K}u_{l}\varphi_{K + 1 - l},
$$
и ее решение определяется выражениями
$$
	u_{k} = u_{0}\psi_{k},\; k=\overline{1,K},\eqno(6)
$$
и
$$
	u_{0} = (\sum\limits_{k=0}^{K}\psi_{k})^{-1}, \eqno(7)
$$
где числа $\psi_{k}$ могут быть вычислены из следующей рекурсии
$$\;\psi_{0} = 1,\; \psi_{k+1}\; =\;(\psi_{k} - \varphi_{k} - \sum\limits_{i=1}^{k}\psi_{i}\varphi_{k + 1 - i})\varphi_{0}^{-1},\; k = \overline{0, K-1}. \eqno(8)$$

Путем подстановки вектора ${\bf y}$ из пункта (4) в неравенство
(2), получаем следующее неравенство
$$
\lambda b_1 + u_{0}  \frac{\lambda}{\gamma}\; <\; 1. \eqno(9)
$$
Таким образом, мы докали следующее утверждение.

{\bf Теорема}
Вложенная ЦМ $\xi_n$ для рассматриваемой системы эргодична тогда и только тогда, когда неравенство (9) выполняется, где $u_{0}$ задается в (7), (8).


{\bf Замечание}
Условие (9) легко интерпретируется, если его переписать в виде
$$
\lambda (b_1 + u_{0}  \frac{1}{\gamma})\; <\; 1. \eqno(10)
$$


Далее будем полагать, что условие (9) выполняется.

\newpage
\section{ Вычисление стационарного распределения вложенной цепи Маркова}

Обозначим
$$\pi(i,k,\nu)=\lim_{n\to \infty} P\{i_n=i, k_n=k, \nu_n=\nu\},$$
$${\boldsymbol \pi}(i,k)= (\pi(i,k,0),\dots,\pi(i,k,W),$$
$${\boldsymbol \pi}_{i}= ({\boldsymbol \pi}(i,0),{\boldsymbol \pi}(i,1),\dots,{\boldsymbol \pi}(i,K)),\; i \ge 0.$$

Хорошо известно, что векторы ${\boldsymbol \pi}_{i},\; i \ge 0,$ удовлетворяют следующей СЛАУ:
$$
{\boldsymbol \pi}_{j}={\boldsymbol \pi}_{0}V_j+\sum\limits_{i=1}^{j+1} {\boldsymbol \pi}_{i}Y_{j-i+1},\; \; j \ge 0. \eqno(11)
$$

Существует нескольно способов вычисления векторов ${\boldsymbol \pi}_{j}\; j \ge 0.$ Один из них основан на использовании векторной производящей функции
$ {\boldsymbol \pi}(z)=\sum\limits_{j=0}^{\infty}{\boldsymbol \pi}_{j}z^j,\; |z|<1.$
Из системы (11) легко получить следующее функциональное уравнение для векторной производящей функции
$ {\boldsymbol \pi}(z)$:
$$
{\boldsymbol \pi}(z)(Y(z)-zI)={\boldsymbol \pi}_0(Y(z)-z V(z)). \eqno(12) $$
Уравнение (12) может быть решено с использованием соображений аналитичности векторной ПФ $ {\boldsymbol \pi}(z)$ в единичном круге комплексной плоскости и существовании заданного числа нулей в определителе матрицы $Y(z)-zI$ в единичном круге.

Второй способ использует последовательное рассмотрение ряда сенсорных ЦМ для ЦМ $\xi_n$, с целью вывода альтернативной СЛАУ для векторов ${\boldsymbol \pi}_{j}\; j \ge 0,$ и ее решения на основе расширения метода М. Ньютса с использованием матрицы $G.$ 

\vspace{3mm}

{\bf Алгоритм.}

 1. Вычисляем матрицу  $G$  как минимальное неотрицательное решение матричного уравнения $ G= Y(G).$

 2. Вычисляем матрицы $\bar P_{i,j}$ следующим образом:
$$
\bar P_{0,j} = \sum\limits_{n=j}^{\infty} V_n G^{n-j}, j \ge 0,
\,\bar P_{i,j} = \sum\limits_{n=j-i+1}^{\infty} Y_n G^{n-j+i-1},\; j
\ge i, \;i \ge 0.
$$
3. Вычисляем матрицы $\Phi_j, j \geq 0,$ используя
рекуррентную формулу
$$
\Phi_j=I_{(W+1)(K+1)}, \,\,\Phi_j =( \bar P_{0,j} + \sum\limits_{i=1}^{j-1} \Phi_i \bar
P_{i,j})(I-  \bar P_{j,j})^{-1},\; j \geq 1.
$$
 4. Вычисляем вектор $\boldsymbol \pi_0$ как единственное
решение системы
$$
\boldsymbol {\pi}_0 (I-\bar P_{0,0}) = {\boldsymbol 0},\,\;
\boldsymbol {\pi}_0 (I+\sum\limits_{j=1}^{\infty}
\Phi_j){\boldsymbol e} = 1.
$$
 5. Вычисляем векторы $\boldsymbol \pi_j$ следующим
образом: $\boldsymbol \pi_j = \boldsymbol \pi_0 \Phi_j, \;j \geq 1.$



%-------------------------------------- Характеристики производительности


\newpage
\section{Характеристики производительности}

Вычислив векторы стационарных вероятностей ${\boldsymbol \pi}_{j}\; j \ge 0,$  можно вычислить различные характеристики производительности системы.


\begin{itemize}
\item [$\bullet$] Среднее число $L$ запросов в системе в момент окончания обслуживания 
$$
L = \sum\limits_{i = 0}^{\infty} i {\boldsymbol \pi}_i {\bf e}.
$$

\item [$\bullet$] Среднее число $N$ единиц энергии в системе непосредственно перед моментом окончания обслуживания
$$
N =\sum\limits_{i = 0}^{\infty} \sum\limits_{k = 1}^{K} k {\boldsymbol \pi}(i,k){\bf e}.
$$
\item [$\bullet$] Вероятность отсутствия запросов в системе в момент окончания обслуживания
$$
P_0^{custom} = {\boldsymbol \pi}_0 {\bf e}.
$$
\item [$\bullet$] Вероятность отсутствия единиц энергии в системе непосредственно перед моментом окончания обслуживания

$$
P_0^{energy} = \sum\limits_{i = 0}^{\infty} {\boldsymbol \pi}(i,0){\bf e}.
$$
\item [$\bullet$] Вероятность простоя прибора в момент окончания обслуживания
$$
P_{idle} = \sum\limits_{i = 1}^{\infty} {\boldsymbol \pi}(i,0){\bf e}.
$$
\item [$\bullet$] Математическое ожидание длины интервала между соседними моментами окончания обслуживания запросов
$$
\tau=b_1+{\boldsymbol \pi}(0,0)(-D_0+\gamma I)^{-1}(D_1\gamma^{-1}+ \gamma (-D_0)^{-1}){\bf e}+\gamma^{-1} \sum\limits_{i=1}^{\infty} {\boldsymbol \pi}(i,0){\bf e}$$$$+\sum\limits_{k=1}^{K} {\boldsymbol \pi}(0,k)(-D_0)^{-1}{\bf e}.
$$
\end{itemize}

 {\bf {Замечание}}
Ввиду отсутствия потерь запросов в исследуемой системе, для нее верно соотношение $\tau=\lambda^{-1}$. Данное выражение удобно для контроля точности вычислений стационарных вероятностей  ${\boldsymbol \pi}_{j}\; j \ge 0.$.

%-------------------------------------- Характеристики производительности (будут написаны) ----------------------------------------


\newpage

\section{Численные эксперименты}

\subsection{Эксперимент 1: Зависимость $L$  от $K$ при различных значениях $b_1$} \label{experiment2}
Целью данного эксперимента является исследование влияния размера буфера $K$  на среднюю длину очереди $L$ при различных значениях интенсивности времени обслуживания $b_1$


Для большей наглядности будем строить четыре кривые, соответствующие различным интенсивностям времени обслуживания. 

Определим входные данные для этого эксперимента.

\textit{Входной $MAP$-поток} задается следующим образом:

$$ D_0= \left(
\begin{array}{cc}
-0.40578 & 0\\
0 & -0.013173 \\
\end{array}
\right),
$$
    $$
    D_1 =\left(
\begin{array}{cc}
0.40308 & 0.0027 \\
0.007338 & 0.005835\\
\end{array}
\right).
$$

Этот $MAP$ имеет $ c_{var}^2=12.34012$, $c_{cor} =0.2, \lambda=0.3$.

\textit{Интенсивность потока энергии} $\gamma=0.4.$

\textit{Точность вычислений} $\varepsilon=10^{-7}.$

\begin{table}[H]
\centering
\caption{Данные, полученных в ходе эксперимента 1, для рис. \ref{fig:K_L_b_1}.}
\label{tab:L_lambda_h_1}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
\hline
\multirow{ 2}{*}{$K$} & \multicolumn{2}{|c|}{$b_1=0.5$}  & \multicolumn{2}{|c|}{$b_1=1$} & \multicolumn{2}{|c|}{$b_1=1.5$}& \multicolumn{2}{|c|}{$b_1=2$}\\
\cline{2-9}
& $L$ & $\rho$ &$L$ & $\rho$ &$L$ & $\rho$ &$L$ & $\rho$\\
\hline
1 &15.7378 & 0.7645 & 24.1425 & 0.8032 & 47.6852 & 0.8621 & 143.056 & 0.9376 \\ \hline
2 &12.9275 & 0.7516 & 14.4641 & 0.7609 & 19.4767 & 0.7873 & 34.56 & 0.8369 \\ \hline
3 &11.9759 & 0.7505 & 12.4906 & 0.7525 & 14.3793 & 0.7638 & 21.2301 & 0.7973 \\ \hline
4 &11.2056 & 0.7504 & 11.5376 & 0.7509 & 12.4967 & 0.7555 & 16.4481 & 0.7779 \\ \hline
5 &10.4933 & 0.7504 & 10.7935 & 0.7505 & 11.4409 & 0.7524 & 14.0519 & 0.7672 \\ \hline
6 &9.8278 & 0.7504 & 10.1231 & 0.7505 & 10.6642 & 0.7512 & 12.5885 & 0.7609 \\ \hline
7 &9.2053 & 0.7504 & 9.5006 & 0.7504 & 10.006 & 0.7507 & 11.5639 & 0.7571 \\ \hline
8 &8.6233 & 0.7504 & 8.9192 & 0.7504 & 9.4133 & 0.7506 & 10.7728 & 0.7547 \\ \hline
9 &8.0789 & 0.7504 & 8.3757 & 0.7504 & 8.8669 & 0.7505 & 10.1192 & 0.7532 \\ \hline
10 &7.5699 & 0.7504 & 7.8675 & 0.7504 & 8.3585 & 0.7505 & 9.5539 & 0.7522 \\ \hline
\end{tabular}
\end{table}

По результатам эксперимента можно сказать, что увеличение размера буфера приводит к уменьшению очереди, причем c каждой новой единицей энергии длина очереди убывает экспоненциально, что логично -- производительность системы все меньше зависит от энергии и после определенного $K$ изменения практически незаметны, так как любой запрос, поступающий на осблуживание, почти всегда находит нужную для проведения данной операции единицу энергии.

Таким образом, для улучшения производительности системы целесообразно увеличивать размер буфера $K$ лишь до определенного порога, соответствующего среднему времени обслуживания системы. 

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{../exp_1/K_L_b_1.png}
	\caption{Зависимость $L$ от $K$ при различных $b_1$ }
	\label{fig:K_L_b_1}
\end{figure}

\newpage
\subsection{Эксперимент 2: Зависимость $L$  от $K$ при различных значениях $c_{cor}$} \label{experiment1}


В данном эксперименте мы будем исследовать зависимость среднего числа запросов на орбите $L$ от размера буфера $K$ 
при различных коэффициентах корреляции в $MAP$

В силу значительного роста величины $L$ при увеличении $c_{cor}$ приведем графики как для $L$, так и для $logL$.

Будем рассматривать три $MAP$-потока, которые будем обозначать как $MAP_1, MAP_2, MAP_3$


{${\bf MAP}_1$.} Стационарный пуассоновский поток интенсивности $\lambda$ ($D_0=-\lambda,\, D_1=\lambda).$ Поток имеет следующие характеристики $ c^2_{var}=1, \,c_{cor}=0.$

{${\bf MAP}_2$.}
В качестве данного потока возьмем $MAP$ из Эксперимента 1. Согласно расчетам, данный поток характеризуется величинами $ c_{var}^2=12.34012$, $c_{cor} =0.2.$

{${\bf MAP}_3$.}
Данный поток задан матрицами
$$ D_0= \left(
\begin{array}{cc}
-0.21632047 & 0\\
0 & -0.00544807 \\
\end{array}
\right).
$$
    $$
    D_1 =\left(
\begin{array}{cc}
0.21601763  & 0.00030285 \\
0.00080119  & 0.00464688 \\
\end{array}
\right).
$$

$MAP$-поток характеризуется величинами  $c^2_{var} =16.022,$ $c_{cor} =0.4$.


На рисунках \ref{fig:K_L_c_cor} - \ref{fig:K_logL_c_cor} изображены графики зависимости среднего числа запросов $L$ и $logL$ от размера буфера  $K$ при различных коэффициентах корреляции: $c_{cor}=0$,\,$c_{cor}=0.2$,\,$c_{cor}=0.4$. 

Основываясь на результатах расчетов, приведенных в таблице \ref{tab:K_L} можно сделать вывод, что с увеличением коэффициента корреляции значительно увеличиваются характеристики, при неизменности остальных параметров системы. Аналогично существенному росту характеристик с увеличением коэффициента корреляции, увеличивается и время выполнения программы, ввиду ухудшения сходимости итерационных процессов, что также стоит учитывать при проведении расчетов. Следовательно, корреляция во входном потоке может существенно влиять на характеристики системы и должна учитываться при расчете ее характеристик и оценке производительности.

\begin{figure}[]
	\centering
	\includegraphics[width=\textwidth]{../exp_2/K_L.png}
	\caption{Зависимость $L$ от $K$ при различных $c_{cor}$ }
	\label{fig:K_L_c_cor}
	\centering
	\includegraphics[width=\textwidth]{../exp_2/K_L_log.png}
	\caption{Зависимость $logL$ от $K$ при различных $c_{cor}$ }
	\label{fig:K_logL_c_cor}
\end{figure}


\begin{table}[H]
\centering
\caption{Результаты эксперимента 2.}
\label{tab:K_L}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
\hline
\multirow{ 2}{*}{$K$} & \multicolumn{3}{|c|}{$c_{cor}=0$}  & \multicolumn{3}{|c|}{$c_{cor}=0.2$} & \multicolumn{3}{|c|}{$c_{cor}=0.33$}\\
\cline{2-10}
& $L$ & $logL$ & $\rho$ &$L$ & $logL$ & $\rho$ &$L$ & $logL$ & $\rho$ \\
\hline
1 &3.2041 & 0.5057 & 0.8027 & 24.0092 & 1.3804 & 0.8027 & 94.1083 & 1.9736 & 0.8027 \\ \hline
2 &2.1065 & 0.3236 & 0.7605 & 14.3867 & 1.158 & 0.7605 & 45.0026 & 1.6532 & 0.7605 \\ \hline
3 &1.6318 & 0.2127 & 0.7521 & 12.4218 & 1.0942 & 0.7521 & 37.4614 & 1.5736 & 0.7521 \\ \hline
4 &1.3103 & 0.1174 & 0.7504 & 11.4712 & 1.0596 & 0.7504 & 35.4059 & 1.5491 & 0.7504 \\ \hline
5 &1.0732 & 0.0307 & 0.7501 & 10.7284 & 1.0305 & 0.7501 & 34.3168 & 1.5355 & 0.7501 \\ \hline
6 &0.8958 & -0.0478 & 0.75 & 10.0593 & 1.0026 & 0.75 & 33.4247 & 1.5241 & 0.75 \\ \hline
7 &0.7629 & -0.1175 & 0.75 & 9.4381 & 0.9749 & 0.75 & 32.5869 & 1.513 & 0.75 \\ \hline
8 &0.6632 & -0.1783 & 0.75 & 8.8582 & 0.9473 & 0.75 & 31.7764 & 1.5021 & 0.75 \\ \hline
9 &0.5885 & -0.2303 & 0.75 & 8.3162 & 0.9199 & 0.75 & 30.9875 & 1.4912 & 0.75 \\ \hline
10 &0.5324 & -0.2737 & 0.75 & 7.8095 & 0.8926 & 0.75 & 30.2188 & 1.4803 & 0.75 \\ \hline
\end{tabular}
\end{table}




\newpage
\subsection{Эксперимент 3: Зависимость $N$  от $K$ при различных значениях $b_1$} \label{experiment3}

Цель данного эксперимента -- исследование влияния размера буфера $K$  на среднее число единиц энергии в буфере $N$ при различных значениях интенсивности времени обслуживания $b_1$

Из графика видно, что с увеличением размера буфера растет и среднее число единиц энергии в буфере. Скорость роста увеличивается с ростом $K$ пока до тех пор, пока зависимость не станет линейной. Связано это с тем, что ввиду уменьшения загрузки системы, в ней все чаще случаются ситуации, когда запросы отсутствуют, что приводит к накоплению энергии. 
\begin{table}[H]
\centering
\caption{Данные, полученных в ходе эксперимента 3, для рис. \ref{fig:N_K_b_1}.}
\label{tab:L_lambda_h_1}
\begin{tabular}{|c|c|c|c|c|}
\hline
\multirow{ 2}{*}{$K$} & \multicolumn{4}{|c|}{$N$}\\
\cline{2-5}
 & $b_1=0.5$  & $b_1=1$ & $b_1=1.5$& $b_1=2$\\
\hline
1 &0.1813 & 0.3297 & 0.4512 & 0.5507 \\ \hline
2 &0.2832 & 0.5193 & 0.7615 & 0.9956 \\ \hline
3 &0.4164 & 0.6856 & 1.0113 & 1.3807 \\ \hline
4 &0.6022 & 0.8807 & 1.2539 & 1.7423 \\ \hline
5 &0.8403 & 1.1211 & 1.5178 & 2.102 \\ \hline
6 &1.1278 & 1.4091 & 1.8162 & 2.4729 \\ \hline
7 &1.4615 & 1.7428 & 2.1543 & 2.8634 \\ \hline
8 &1.8384 & 2.1197 & 2.5328 & 3.2788 \\ \hline
9 &2.2556 & 2.5369 & 2.9508 & 3.7223 \\ \hline
10 &2.7107 & 2.992 & 3.4061 & 4.1955 \\ \hline

\end{tabular}
\quad
\begin{tabular}{|c|c|c|c|c|}
\hline
\multirow{ 2}{*}{$K$} & \multicolumn{4}{|c|}{$N$}\\
\cline{2-5}
 & $b_1=0.5$  & $b_1=1$ & $b_1=1.5$& $b_1=2$\\
\hline
11 &3.201 & 3.4824 & 3.8968 & 4.699 \\ \hline
12 &3.7244 & 4.0058 & 4.4204 & 5.2323 \\ \hline
13 &4.2787 & 4.5601 & 4.975 & 5.7945 \\ \hline
14 &4.8619 & 5.1433 & 5.5585 & 6.3846 \\ \hline
15 &5.4721 & 5.7535 & 6.169 & 7.0009 \\ \hline
16 &6.1076 & 6.389 & 6.8048 & 7.6422 \\ \hline
17 &6.7667 & 7.0481 & 7.4643 & 8.3069 \\ \hline
18 &7.4479 & 7.7293 & 8.1458 & 8.9935 \\ \hline
19 &8.1497 & 8.4312 & 8.848 & 9.7007 \\ \hline
20 &8.8709 & 9.1524 & 9.5694 & 10.4271 \\ \hline

\end{tabular}
\end{table}

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{../exp_3/K_N_b_1.png}
	\caption{Зависимость $N$ от $K$ при различных $b_1$ }
	\label{fig:N_K_b_1}
\end{figure}

\newpage
\subsection{Эксперимент 4: Зависимость $P_0^{custom}$  от $K$ при различных значениях $b_1$} \label{experiment4}

Целью данного эксперимента является исследование влияния размера буфера $K$  на вероятность отсутствия запросов в системе $P_0^{custom}$ при различных значениях интенсивности времени обслуживания $b_1$

С увеличением размера буфера $K$ до определенного размера растет и вероятность отсутствия запросов в системе. Данный график снова подтверждает факт того, что увеличение размера буфера имеет смысл лишь до определенной степени. 

\begin{table}[H]
\centering
\caption{Данные, полученных в ходе эксперимента 4, для рис. \ref{fig:K_P_custom_b_1}.}
\label{tab:L_lambda_h_1}
\begin{tabular}{|c|c|c|c|c|}
\hline
\multirow{ 2}{*}{$K$} & \multicolumn{4}{|c|}{$P_0^{custom}$}\\
\cline{2-5}
 & $b_1=0.5$  & $b_1=1$ & $b_1=1.5$& $b_1=2$\\
\hline
1 &0.0938 & 0.0531 & 0.0237 & 0.0072 \\ \hline
2 &0.1494 & 0.1092 & 0.0658 & 0.0302 \\ \hline
3 &0.1927 & 0.1476 & 0.0991 & 0.0508 \\ \hline
4 &0.2321 & 0.1785 & 0.124 & 0.0677 \\ \hline
5 &0.2689 & 0.2062 & 0.1443 & 0.0813 \\ \hline
6 &0.3033 & 0.2318 & 0.162 & 0.0925 \\ \hline
7 &0.3355 & 0.2557 & 0.178 & 0.1019 \\ \hline
8 &0.3656 & 0.278 & 0.1928 & 0.1101 \\ \hline
9 &0.3937 & 0.2989 & 0.2064 & 0.1173 \\ \hline
10 &0.42 & 0.3184 & 0.2191 & 0.1238 \\ \hline
\end{tabular}
\quad
\begin{tabular}{|c|c|c|c|c|}
\hline
\multirow{ 2}{*}{$K$} & \multicolumn{4}{|c|}{$P_0^{custom}$}\\
\cline{2-5}
 & $b_1=0.5$  & $b_1=1$ & $b_1=1.5$& $b_1=2$\\
\hline
11 &0.4446 & 0.3366 & 0.231 & 0.1297 \\ \hline
12 &0.4676 & 0.3537 & 0.242 & 0.1351 \\ \hline
13 &0.4892 & 0.3696 & 0.2524 & 0.14 \\ \hline
14 &0.5093 & 0.3845 & 0.262 & 0.1446 \\ \hline
15 &0.5281 & 0.3985 & 0.2711 & 0.1489 \\ \hline
16 &0.5457 & 0.4115 & 0.2795 & 0.1528 \\ \hline
17 &0.5622 & 0.4237 & 0.2874 & 0.1564 \\ \hline
18 &0.5775 & 0.4351 & 0.2948 & 0.1598 \\ \hline
19 &0.5919 & 0.4458 & 0.3017 & 0.163 \\ \hline
20 &0.6054 & 0.4558 & 0.3081 & 0.1659 \\ \hline
\end{tabular}
\end{table}

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{../exp_4/K_P_custom_b_1.png}
	\caption{Зависимость $P_0^{custom}$ от $K$ при различных $b_1$ }
	\label{fig:K_P_custom_b_1}
\end{figure}



\newpage
\subsection{Эксперимент 5: Зависимость $P_{energy}$ и $P_{idle}$ от $K$ при различных значениях $b_1$} \label{experiment4}
Целью данного эксперимента является исследование влияния размера буфера $K$  на вероятность отсутствия единиц энергии в буфере $P_0^{energy}$ и вероятность простоя системы $P_{idle}$ при различных значениях интенсивности времени обслуживания $b_1$

Из графика видно, что с увеличением размера буфера падают исследуемые вероятности. Увеличение среднего времени обслуживания приводит к уменьшению $P_0^{energy}$ и $P_{idle}$, так как система хуже справляется с потоком запросов.

\begin{table}[H]
\centering
\caption{Данные, полученных в ходе эксперимента 5, для рис. \ref{fig:K_P_energy_b_1} - \ref{fig:K_P_idle_b_1}.}
\label{tab:L_lambda_h_1}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
\hline
\multirow{ 2}{*}{$K$} & \multicolumn{2}{|c|}{$b_1=0.5$}  & \multicolumn{2}{|c|}{$b_1=1$} & \multicolumn{2}{|c|}{$b_1=1.5$}& \multicolumn{2}{|c|}{$b_1=2$}\\
\cline{2-9}
& $P_{energy}$ & $P_{idle}$ &$P_{energy}$ & $P_{idle}$ &$P_{energy}$ & $P_{idle}$ &$P_{energy}$ & $P_{idle}$\\
\hline
1 &0.8187 & 0.7419 & 0.6703 & 0.6347 & 0.5488 & 0.5358 & 0.4493 & 0.4461 \\ \hline
2 &0.7484 & 0.6733 & 0.5788 & 0.537 & 0.4311 & 0.4128 & 0.3084 & 0.3026 \\ \hline
3 &0.6983 & 0.6278 & 0.5308 & 0.4904 & 0.377 & 0.3582 & 0.2464 & 0.2403 \\ \hline
4 &0.6528 & 0.5869 & 0.494 & 0.4562 & 0.3429 & 0.3251 & 0.2106 & 0.2048 \\ \hline
5 &0.6105 & 0.5489 & 0.4614 & 0.4261 & 0.3169 & 0.3004 & 0.1864 & 0.1811 \\ \hline
6 &0.5709 & 0.5133 & 0.4313 & 0.3984 & 0.2948 & 0.2795 & 0.1683 & 0.1635 \\ \hline
7 &0.5339 & 0.48 & 0.4033 & 0.3726 & 0.275 & 0.2608 & 0.1538 & 0.1494 \\ \hline
8 &0.4993 & 0.4489 & 0.3771 & 0.3484 & 0.2568 & 0.2436 & 0.1416 & 0.1376 \\ \hline
9 &0.4669 & 0.4198 & 0.3526 & 0.3258 & 0.24 & 0.2277 & 0.1309 & 0.1273 \\ \hline
10 &0.4367 & 0.3926 & 0.3298 & 0.3047 & 0.2243 & 0.2128 & 0.1215 & 0.1181 \\ \hline
11 &0.4084 & 0.3672 & 0.3084 & 0.2849 & 0.2097 & 0.199 & 0.1129 & 0.1098 \\ \hline
12 &0.3819 & 0.3434 & 0.2884 & 0.2665 & 0.1961 & 0.186 & 0.1051 & 0.1023 \\ \hline
13 &0.3571 & 0.3211 & 0.2697 & 0.2492 & 0.1833 & 0.174 & 0.0979 & 0.0953 \\ \hline
14 &0.334 & 0.3003 & 0.2522 & 0.233 & 0.1714 & 0.1627 & 0.0913 & 0.0889 \\ \hline
15 &0.3123 & 0.2808 & 0.2359 & 0.2179 & 0.1603 & 0.1521 & 0.0852 & 0.0829 \\ \hline
16 &0.2921 & 0.2626 & 0.2206 & 0.2038 & 0.1499 & 0.1422 & 0.0795 & 0.0774 \\ \hline
17 &0.2732 & 0.2456 & 0.2063 & 0.1906 & 0.1402 & 0.133 & 0.0742 & 0.0722 \\ \hline
18 &0.2555 & 0.2297 & 0.1929 & 0.1782 & 0.1311 & 0.1244 & 0.0693 & 0.0675 \\ \hline
19 &0.2389 & 0.2148 & 0.1804 & 0.1667 & 0.1226 & 0.1163 & 0.0647 & 0.063 \\ \hline
20 &0.2234 & 0.2009 & 0.1687 & 0.1559 & 0.1146 & 0.1088 & 0.0604 & 0.0588 \\ \hline
\end{tabular}
\end{table}

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{../exp_5/K_P_energy_b_1.png}
	\caption{Зависимость $P_0^{energy}$ от $K$ при различных $b_1$ }
	\label{fig:K_P_energy_b_1}

	\centering
	\includegraphics[width=\textwidth]{../exp_5/K_P_idle_b_1.png}
	\caption{Зависимость $P_{idle}$ от $K$ при различных $b_1$ }
	\label{fig:K_P_idle_b_1}
\end{figure}

\newpage


\begin{center} {\bf {ЗАКЛЮЧЕНИЕ}} \end{center}

В данном курсовом проекте рассмотрена система массового обслуживания с запасами как модель узла беспроводной сенсорной сети со сбором энергии. Построена цепь Маркова и выведены матрицы вероятностных переходов, найдены условия эргодичности и основные характеристики системы. Реализован алгоритм нахождения стационарного распределения. Проведены численные эксперименты и построены графики для исследования поведения системы в зависимости от некоторых параметров.

\newpage
%-------------------------------------- Список литературы  ----------------------------------------

\begin{thebibliography}{3}

\bibitem{bi:1} Вишневский В.М., Дудин А.Н., Клименок В.И. Стохастические системы с коррелированными потоками. Теория и применение в телекоммуникационных сетях. Москва: ТЕХНОСФЕРА, 2018. - С.193-198, С.304-318.

\bibitem{KlDud} В.И.Клименок, В.М. Вишневский. Стационарные характеристики ненадежной системы массового обслуживания с марковским потоком и резервным прибором // Distributed Computer and Communication Networks: Control, Computation, Communications (DCCN—2016),  21—25  November, 2016,  Moscow,  Russia – Т. 1. С.93-100.

\bibitem{bi:3} Ю. С. Харин, Н. М. Зуев, Е. Е. Жук. Теория вероятностей, математическая и прикладная статистика.  Минск: БГУ, 2011. – C.213-226

\bibitem{luk}
   Lucantoni, D.M.  New results on the single server queue with a
batch Markovian arrival process, Communications in
Statistics-Stochastic Models. 7  (1991) 1-46.

\end{thebibliography}




\end{document} 